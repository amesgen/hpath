<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      :  HPath</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Copyright   :  &#169; 2015&#8211;2016 FP Complete, 2016 Julian Ospald</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- License     :  BSD 3 clause</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  :  Julian Ospald &lt;hasufell@posteo.de&gt;</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Portability :  portable</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Support for well-typed paths.</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE EmptyDataDecls #-}</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 708
</span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HPath</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-23"></span><span>   </span><span class="annot"><a href="HPath.html#Abs"><span class="hs-identifier">Abs</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier">Path</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#Rel"><span class="hs-identifier">Rel</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#Fn"><span class="hs-identifier">Fn</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#PathParseException"><span class="hs-identifier">PathParseException</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#PathException"><span class="hs-identifier">PathException</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#RelC"><span class="hs-identifier">RelC</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 708
</span><span>  </span><span class="annot"><span class="hs-comment">-- * PatternSynonyms/ViewPatterns</span></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="HPath.html#Path"><span class="hs-identifier">Path</span></a></span><span class="hs-cpp">
#endif
</span><span>   </span><span class="annot"><span class="hs-comment">-- * Path Parsing</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#parseAbs"><span class="hs-identifier">parseAbs</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#parseFn"><span class="hs-identifier">parseFn</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#parseRel"><span class="hs-identifier">parseRel</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Path Conversion</span></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#fromAbs"><span class="hs-identifier">fromAbs</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#fromRel"><span class="hs-identifier">fromRel</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#toFilePath"><span class="hs-identifier">toFilePath</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Path Operations</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#%3C%2F%3E"><span class="hs-operator">(&lt;/&gt;)</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#basename"><span class="hs-identifier">basename</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#dirname"><span class="hs-identifier">dirname</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#isParentOf"><span class="hs-identifier">isParentOf</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#getAllParents"><span class="hs-identifier">getAllParents</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#stripDir"><span class="hs-identifier">stripDir</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Path IO helpers</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#withAbsPath"><span class="hs-identifier">withAbsPath</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#withRelPath"><span class="hs-identifier">withRelPath</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span class="annot"><a href="HPath.html#withFnPath"><span class="hs-identifier">withFnPath</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Exception</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Catch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadThrow</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#if MIN_VERSION_bytestring(0,10,8)
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stripPrefix</span></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.ByteString</span><span class="hs-special">(</span><span class="hs-identifier">ByteString</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Word8</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HPath.Internal.html"><span class="hs-identifier">HPath.Internal</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="System.Posix.FilePath.html"><span class="hs-identifier">System.Posix.FilePath</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Posix.FilePath.html#%3C%2F%3E"><span class="hs-operator">(&lt;/&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- Types</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | An absolute path.</span><span>
</span><span id="line-76"></span><span class="hs-keyword">data</span><span> </span><span id="Abs"><span class="annot"><a href="HPath.html#Abs"><span class="hs-identifier hs-var">Abs</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | A relative path; one without a root.</span><span>
</span><span id="line-79"></span><span class="hs-keyword">data</span><span> </span><span id="Rel"><span class="annot"><a href="HPath.html#Rel"><span class="hs-identifier hs-var">Rel</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | A filename, without any '/'.</span><span>
</span><span id="line-82"></span><span class="hs-keyword">data</span><span> </span><span id="Fn"><span class="annot"><a href="HPath.html#Fn"><span class="hs-identifier hs-var">Fn</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | Exception when parsing a location.</span><span>
</span><span id="line-85"></span><span class="hs-keyword">data</span><span> </span><span id="PathParseException"><span class="annot"><a href="HPath.html#PathParseException"><span class="hs-identifier hs-var">PathParseException</span></a></span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="InvalidAbs"><span class="annot"><a href="HPath.html#InvalidAbs"><span class="hs-identifier hs-var">InvalidAbs</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InvalidRel"><span class="annot"><a href="HPath.html#InvalidRel"><span class="hs-identifier hs-var">InvalidRel</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InvalidFn"><span class="annot"><a href="HPath.html#InvalidFn"><span class="hs-identifier hs-var">InvalidFn</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Couldn%27tStripPrefixTPS"><span class="annot"><a href="HPath.html#Couldn%27tStripPrefixTPS"><span class="hs-identifier hs-var">Couldn'tStripPrefixTPS</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679094318"><span id="local-6989586621679094320"><span id="local-6989586621679094322"><span class="annot"><span class="annottext">Int -&gt; PathParseException -&gt; ShowS
[PathParseException] -&gt; ShowS
PathParseException -&gt; String
(Int -&gt; PathParseException -&gt; ShowS)
-&gt; (PathParseException -&gt; String)
-&gt; ([PathParseException] -&gt; ShowS)
-&gt; Show PathParseException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PathParseException] -&gt; ShowS
$cshowList :: [PathParseException] -&gt; ShowS
show :: PathParseException -&gt; String
$cshow :: PathParseException -&gt; String
showsPrec :: Int -&gt; PathParseException -&gt; ShowS
$cshowsPrec :: Int -&gt; PathParseException -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679094309"><span id="local-6989586621679094311"><span id="local-6989586621679094313"><span class="annot"><span class="hs-identifier hs-type">Exception</span></span><span> </span><span class="annot"><a href="HPath.html#PathParseException"><span class="hs-identifier hs-type">PathParseException</span></a></span></span></span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">data</span><span> </span><span id="PathException"><span class="annot"><a href="HPath.html#PathException"><span class="hs-identifier hs-var">PathException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RootDirHasNoBasename"><span class="annot"><a href="HPath.html#RootDirHasNoBasename"><span class="hs-identifier hs-var">RootDirHasNoBasename</span></a></span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679094301"><span id="local-6989586621679094303"><span id="local-6989586621679094305"><span class="annot"><span class="annottext">Int -&gt; PathException -&gt; ShowS
[PathException] -&gt; ShowS
PathException -&gt; String
(Int -&gt; PathException -&gt; ShowS)
-&gt; (PathException -&gt; String)
-&gt; ([PathException] -&gt; ShowS)
-&gt; Show PathException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PathException] -&gt; ShowS
$cshowList :: [PathException] -&gt; ShowS
show :: PathException -&gt; String
$cshow :: PathException -&gt; String
showsPrec :: Int -&gt; PathException -&gt; ShowS
$cshowsPrec :: Int -&gt; PathException -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679094293"><span id="local-6989586621679094295"><span id="local-6989586621679094297"><span class="annot"><span class="hs-identifier hs-type">Exception</span></span><span> </span><span class="annot"><a href="HPath.html#PathException"><span class="hs-identifier hs-type">PathException</span></a></span></span></span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">class</span><span> </span><span id="RelC"><span class="annot"><a href="HPath.html#RelC"><span class="hs-identifier hs-var">RelC</span></a></span></span><span> </span><span id="local-6989586621679094388"><span class="annot"><a href="#local-6989586621679094388"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="HPath.html#RelC"><span class="hs-identifier hs-type">RelC</span></a></span><span> </span><span class="annot"><a href="HPath.html#Rel"><span class="hs-identifier hs-type">Rel</span></a></span><span>
</span><span id="line-100"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="HPath.html#RelC"><span class="hs-identifier hs-type">RelC</span></a></span><span> </span><span class="annot"><a href="HPath.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- PatternSynonyms</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 710
</span><span id="local-6989586621679094385"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="HPath.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094385"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708
</span><span class="hs-keyword">pattern</span><span> </span><span id="%24mPath"><span id="Path"><span class="annot"><span class="annottext">$mPath :: forall r a. Path a -&gt; (ByteString -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="HPath.html#%24mPath"><span class="hs-identifier hs-var hs-var">Path</span></a></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679094290"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-type">MkPath</span></a></span><span> </span><span id="local-6989586621679094290"><span class="annot"><a href="#local-6989586621679094290"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-112"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- Path Parsers</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-comment">-- | Get a location for an absolute path. Produces a normalised path.</span><span>
</span><span id="line-118"></span><span class="hs-comment">--</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- Throws: 'PathParseException'</span><span>
</span><span id="line-120"></span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- &gt;&gt;&gt; parseAbs &quot;/abc&quot;          :: Maybe (Path Abs)</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- Just &quot;/abc&quot;</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- &gt;&gt;&gt; parseAbs &quot;/&quot;             :: Maybe (Path Abs)</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- Just &quot;/&quot;</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- &gt;&gt;&gt; parseAbs &quot;/abc/def&quot;      :: Maybe (Path Abs)</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- Just &quot;/abc/def&quot;</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- &gt;&gt;&gt; parseAbs &quot;/abc/def/.///&quot; :: Maybe (Path Abs)</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- Just &quot;/abc/def/&quot;</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- &gt;&gt;&gt; parseAbs &quot;abc&quot;           :: Maybe (Path Abs)</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- &gt;&gt;&gt; parseAbs &quot;&quot;              :: Maybe (Path Abs)</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- &gt;&gt;&gt; parseAbs &quot;/abc/../foo&quot;   :: Maybe (Path Abs)</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-135"></span><span id="local-6989586621679094288"><span class="annot"><a href="HPath.html#parseAbs"><span class="hs-identifier hs-type">parseAbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679094288"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-136"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094288"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="HPath.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-137"></span><span id="parseAbs"><span class="annot"><span class="annottext">parseAbs :: ByteString -&gt; m (Path Abs)
</span><a href="HPath.html#parseAbs"><span class="hs-identifier hs-var hs-var">parseAbs</span></a></span></span><span> </span><span id="local-6989586621679094287"><span class="annot"><span class="annottext">filepath :: ByteString
</span><a href="#local-6989586621679094287"><span class="hs-identifier hs-var">filepath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="System.Posix.FilePath.html#isAbsolute"><span class="hs-identifier hs-var">isAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094287"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-139"></span><span>     </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="System.Posix.FilePath.html#isValid"><span class="hs-identifier hs-var">isValid</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094287"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-140"></span><span>     </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="System.Posix.FilePath.html#hasParentDir"><span class="hs-identifier hs-var">hasParentDir</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094287"><span class="hs-identifier hs-var">filepath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Path Abs -&gt; m (Path Abs)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Path Abs
forall b. ByteString -&gt; Path b
</span><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-var">MkPath</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Path Abs) -&gt; ByteString -&gt; Path Abs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="System.Posix.FilePath.html#normalise"><span class="hs-identifier hs-var">normalise</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094287"><span class="hs-identifier hs-var">filepath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PathParseException -&gt; m (Path Abs)
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PathParseException
</span><a href="HPath.html#InvalidAbs"><span class="hs-identifier hs-var">InvalidAbs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094287"><span class="hs-identifier hs-var">filepath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- | Get a location for a relative path. Produces a normalised</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- path.</span><span>
</span><span id="line-147"></span><span class="hs-comment">--</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- Note that @filepath@ may contain any number of @./@ but may not consist</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- solely of @./@.  It also may not contain a single @..@ anywhere.</span><span>
</span><span id="line-150"></span><span class="hs-comment">--</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- Throws: 'PathParseException'</span><span>
</span><span id="line-152"></span><span class="hs-comment">--</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- &gt;&gt;&gt; parseRel &quot;abc&quot;        :: Maybe (Path Rel)</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- Just &quot;abc&quot;</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- &gt;&gt;&gt; parseRel &quot;def/&quot;       :: Maybe (Path Rel)</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- Just &quot;def/&quot;</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- &gt;&gt;&gt; parseRel &quot;abc/def&quot;    :: Maybe (Path Rel)</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- Just &quot;abc/def&quot;</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- &gt;&gt;&gt; parseRel &quot;abc/def/.&quot;  :: Maybe (Path Rel)</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- Just &quot;abc/def/&quot;</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- &gt;&gt;&gt; parseRel &quot;/abc&quot;       :: Maybe (Path Rel)</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- &gt;&gt;&gt; parseRel &quot;&quot;           :: Maybe (Path Rel)</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- &gt;&gt;&gt; parseRel &quot;abc/../foo&quot; :: Maybe (Path Rel)</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- &gt;&gt;&gt; parseRel &quot;.&quot;          :: Maybe (Path Rel)</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- &gt;&gt;&gt; parseRel &quot;..&quot;         :: Maybe (Path Rel)</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-171"></span><span id="local-6989586621679094279"><span class="annot"><a href="HPath.html#parseRel"><span class="hs-identifier hs-type">parseRel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679094279"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-172"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094279"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="HPath.html#Rel"><span class="hs-identifier hs-type">Rel</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-173"></span><span id="parseRel"><span class="annot"><span class="annottext">parseRel :: ByteString -&gt; m (Path Rel)
</span><a href="HPath.html#parseRel"><span class="hs-identifier hs-var hs-var">parseRel</span></a></span></span><span> </span><span id="local-6989586621679094278"><span class="annot"><span class="annottext">filepath :: ByteString
</span><a href="#local-6989586621679094278"><span class="hs-identifier hs-var">filepath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="System.Posix.FilePath.html#isAbsolute"><span class="hs-identifier hs-var">isAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094278"><span class="hs-identifier hs-var">filepath</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-175"></span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094278"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.singleton</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier hs-var">_period</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-176"></span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094278"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.pack</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier hs-var">_period</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier hs-var">_period</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-177"></span><span>     </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="System.Posix.FilePath.html#hasParentDir"><span class="hs-identifier hs-var">hasParentDir</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094278"><span class="hs-identifier hs-var">filepath</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-178"></span><span>     </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="System.Posix.FilePath.html#isValid"><span class="hs-identifier hs-var">isValid</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094278"><span class="hs-identifier hs-var">filepath</span></a></span><span>
</span><span id="line-179"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Path Rel -&gt; m (Path Rel)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Path Rel
forall b. ByteString -&gt; Path b
</span><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-var">MkPath</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Path Rel) -&gt; ByteString -&gt; Path Rel
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="System.Posix.FilePath.html#normalise"><span class="hs-identifier hs-var">normalise</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094278"><span class="hs-identifier hs-var">filepath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PathParseException -&gt; m (Path Rel)
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PathParseException
</span><a href="HPath.html#InvalidRel"><span class="hs-identifier hs-var">InvalidRel</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094278"><span class="hs-identifier hs-var">filepath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- | Parses a filename. Filenames must not contain slashes.</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- Excludes '.' and '..'.</span><span>
</span><span id="line-185"></span><span class="hs-comment">--</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- Throws: 'PathParseException'</span><span>
</span><span id="line-187"></span><span class="hs-comment">--</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFn &quot;abc&quot;        :: Maybe (Path Fn)</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- Just &quot;abc&quot;</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFn &quot;...&quot;        :: Maybe (Path Fn)</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- Just &quot;...&quot;</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFn &quot;def/&quot;       :: Maybe (Path Fn)</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFn &quot;abc/def&quot;    :: Maybe (Path Fn)</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFn &quot;abc/def/.&quot;  :: Maybe (Path Fn)</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFn &quot;/abc&quot;       :: Maybe (Path Fn)</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFn &quot;&quot;           :: Maybe (Path Fn)</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFn &quot;abc/../foo&quot; :: Maybe (Path Fn)</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFn &quot;.&quot;          :: Maybe (Path Fn)</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFn &quot;..&quot;         :: Maybe (Path Fn)</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-208"></span><span id="local-6989586621679094273"><span class="annot"><a href="HPath.html#parseFn"><span class="hs-identifier hs-type">parseFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679094273"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-209"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094273"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="HPath.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-210"></span><span id="parseFn"><span class="annot"><span class="annottext">parseFn :: ByteString -&gt; m (Path Fn)
</span><a href="HPath.html#parseFn"><span class="hs-identifier hs-var hs-var">parseFn</span></a></span></span><span> </span><span id="local-6989586621679094272"><span class="annot"><span class="annottext">filepath :: ByteString
</span><a href="#local-6989586621679094272"><span class="hs-identifier hs-var">filepath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="System.Posix.FilePath.html#isFileName"><span class="hs-identifier hs-var">isFileName</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094272"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-212"></span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094272"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.singleton</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier hs-var">_period</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-213"></span><span>     </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094272"><span class="hs-identifier hs-var">filepath</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.pack</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier hs-var">_period</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier hs-var">_period</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-214"></span><span>     </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="System.Posix.FilePath.html#isValid"><span class="hs-identifier hs-var">isValid</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094272"><span class="hs-identifier hs-var">filepath</span></a></span><span>
</span><span id="line-215"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Path Fn -&gt; m (Path Fn)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Path Fn
forall b. ByteString -&gt; Path b
</span><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-var">MkPath</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094272"><span class="hs-identifier hs-var">filepath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PathParseException -&gt; m (Path Fn)
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PathParseException
</span><a href="HPath.html#InvalidFn"><span class="hs-identifier hs-var">InvalidFn</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094272"><span class="hs-identifier hs-var">filepath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- Path Conversion</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | Convert any Path to a ByteString type.</span><span>
</span><span id="line-224"></span><span id="local-6989586621679094365"><span class="annot"><a href="HPath.html#toFilePath"><span class="hs-identifier hs-type">toFilePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094365"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span></span><span>
</span><span id="line-225"></span><span id="toFilePath"><span class="annot"><span class="annottext">toFilePath :: Path b -&gt; ByteString
</span><a href="HPath.html#toFilePath"><span class="hs-identifier hs-var hs-var">toFilePath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-type">MkPath</span></a></span><span> </span><span id="local-6989586621679094270"><span class="annot"><span class="annottext">l :: ByteString
</span><a href="#local-6989586621679094270"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094270"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">-- | Convert an absolute Path to a ByteString type.</span><span>
</span><span id="line-228"></span><span class="annot"><a href="HPath.html#fromAbs"><span class="hs-identifier hs-type">fromAbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="HPath.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-229"></span><span id="fromAbs"><span class="annot"><span class="annottext">fromAbs :: Path Abs -&gt; ByteString
</span><a href="HPath.html#fromAbs"><span class="hs-identifier hs-var hs-var">fromAbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path Abs -&gt; ByteString
forall b. Path b -&gt; ByteString
</span><a href="HPath.html#toFilePath"><span class="hs-identifier hs-var">toFilePath</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Convert a relative Path to a ByteString type.</span><span>
</span><span id="line-232"></span><span id="local-6989586621679094269"><span class="annot"><a href="HPath.html#fromRel"><span class="hs-identifier hs-type">fromRel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HPath.html#RelC"><span class="hs-identifier hs-type">RelC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094269"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094269"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span></span><span>
</span><span id="line-233"></span><span id="fromRel"><span class="annot"><span class="annottext">fromRel :: Path r -&gt; ByteString
</span><a href="HPath.html#fromRel"><span class="hs-identifier hs-var hs-var">fromRel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path r -&gt; ByteString
forall b. Path b -&gt; ByteString
</span><a href="HPath.html#toFilePath"><span class="hs-identifier hs-var">toFilePath</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- Path Operations</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- | Append two paths.</span><span>
</span><span id="line-241"></span><span class="hs-comment">--</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- The second argument must always be a relative path, which ensures</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- that undefinable things like `&quot;/abc&quot; &lt;/&gt; &quot;/def&quot;` cannot happen.</span><span>
</span><span id="line-244"></span><span class="hs-comment">--</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- Technically, the first argument can be a path that points to a non-directory,</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- because this library is IO-agnostic and makes no assumptions about</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- file types.</span><span>
</span><span id="line-248"></span><span class="hs-comment">--</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- &gt;&gt;&gt; (MkPath &quot;/&quot;)        &lt;/&gt; (MkPath &quot;file&quot;     :: Path Rel)</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- &quot;/file&quot;</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- &gt;&gt;&gt; (MkPath &quot;/path/to&quot;) &lt;/&gt; (MkPath &quot;file&quot;     :: Path Rel)</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- &quot;/path/to/file&quot;</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- &gt;&gt;&gt; (MkPath &quot;/&quot;)        &lt;/&gt; (MkPath &quot;file/lal&quot; :: Path Rel)</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- &quot;/file/lal&quot;</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- &gt;&gt;&gt; (MkPath &quot;/&quot;)        &lt;/&gt; (MkPath &quot;file/&quot;    :: Path Rel)</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- &quot;/file/&quot;</span><span>
</span><span id="line-257"></span><span id="local-6989586621679094267"><span id="local-6989586621679094268"><span class="annot"><a href="HPath.html#%3C%2F%3E"><span class="hs-operator hs-type">(&lt;/&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HPath.html#RelC"><span class="hs-identifier hs-type">RelC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094268"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094267"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094268"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094267"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-258"></span><span id="%3C%2F%3E"><span class="annot"><span class="annottext">&lt;/&gt; :: Path b -&gt; Path r -&gt; Path b
</span><a href="HPath.html#%3C%2F%3E"><span class="hs-operator hs-var hs-var">(&lt;/&gt;)</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-type">MkPath</span></a></span><span> </span><span id="local-6989586621679094266"><span class="annot"><span class="annottext">a :: ByteString
</span><a href="#local-6989586621679094266"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-type">MkPath</span></a></span><span> </span><span id="local-6989586621679094265"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679094265"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Path b
forall b. ByteString -&gt; Path b
</span><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-var">MkPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094264"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><span class="hs-operator hs-var">`BS.append`</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094265"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621679094264"><span class="annot"><span class="annottext">a' :: ByteString
</span><a href="#local-6989586621679094264"><span class="hs-identifier hs-var hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Word8
</span><span class="hs-identifier hs-var">BS.last</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094266"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="System.Posix.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a></span><span>
</span><span id="line-261"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094266"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-262"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="System.Posix.FilePath.html#addTrailingPathSeparator"><span class="hs-identifier hs-var">addTrailingPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094266"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | Strip directory from path, making it relative to that directory.</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- Throws 'Couldn'tStripPrefixDir' if directory is not a parent of the path.</span><span>
</span><span id="line-266"></span><span class="hs-comment">--</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- The bases must match.</span><span>
</span><span id="line-268"></span><span class="hs-comment">--</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- &gt;&gt;&gt; (MkPath &quot;/lal/lad&quot;)     `stripDir` (MkPath &quot;/lal/lad/fad&quot;) :: Maybe (Path Rel)</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- Just &quot;fad&quot;</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- &gt;&gt;&gt; (MkPath &quot;lal/lad&quot;)      `stripDir` (MkPath &quot;lal/lad/fad&quot;)  :: Maybe (Path Rel)</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- Just &quot;fad&quot;</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- &gt;&gt;&gt; (MkPath &quot;/&quot;)            `stripDir` (MkPath &quot;/&quot;)            :: Maybe (Path Rel)</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- &gt;&gt;&gt; (MkPath &quot;/lal/lad/fad&quot;) `stripDir` (MkPath &quot;/lal/lad&quot;)     :: Maybe (Path Rel)</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- &gt;&gt;&gt; (MkPath &quot;fad&quot;)          `stripDir` (MkPath &quot;fad&quot;)          :: Maybe (Path Rel)</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-279"></span><span id="local-6989586621679094356"><span id="local-6989586621679094357"><span class="annot"><a href="HPath.html#stripDir"><span class="hs-identifier hs-type">stripDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679094357"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-280"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094356"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094356"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094357"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="HPath.html#Rel"><span class="hs-identifier hs-type">Rel</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-281"></span><span id="stripDir"><span class="annot"><span class="annottext">stripDir :: Path b -&gt; Path b -&gt; m (Path Rel)
</span><a href="HPath.html#stripDir"><span class="hs-identifier hs-var hs-var">stripDir</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-type">MkPath</span></a></span><span> </span><span id="local-6989586621679094259"><span class="annot"><span class="annottext">p :: ByteString
</span><a href="#local-6989586621679094259"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-type">MkPath</span></a></span><span> </span><span id="local-6989586621679094258"><span class="annot"><span class="annottext">l :: ByteString
</span><a href="#local-6989586621679094258"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Maybe ByteString
</span><span class="hs-identifier hs-var">stripPrefix</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094257"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094258"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PathParseException -&gt; m (Path Rel)
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; PathParseException
</span><a href="HPath.html#Couldn%27tStripPrefixTPS"><span class="hs-identifier hs-var">Couldn'tStripPrefixTPS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094257"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094258"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679094256"><span class="annot"><span class="annottext">ok :: ByteString
</span><a href="#local-6989586621679094256"><span class="hs-identifier hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094256"><span class="hs-identifier hs-var">ok</span></a></span><span>
</span><span id="line-285"></span><span>                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PathParseException -&gt; m (Path Rel)
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; PathParseException
</span><a href="HPath.html#Couldn%27tStripPrefixTPS"><span class="hs-identifier hs-var">Couldn'tStripPrefixTPS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094257"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094258"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Path Rel -&gt; m (Path Rel)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Path Rel
forall b. ByteString -&gt; Path b
</span><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-var">MkPath</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094256"><span class="hs-identifier hs-var">ok</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621679094257"><span class="annot"><span class="annottext">p' :: ByteString
</span><a href="#local-6989586621679094257"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="System.Posix.FilePath.html#addTrailingPathSeparator"><span class="hs-identifier hs-var">addTrailingPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094259"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- | Is p a parent of the given location? Implemented in terms of</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- 'stripDir'. The bases must match.</span><span>
</span><span id="line-292"></span><span class="hs-comment">--</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- &gt;&gt;&gt; (MkPath &quot;/lal/lad&quot;)     `isParentOf` (MkPath &quot;/lal/lad/fad&quot;)</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- &gt;&gt;&gt; (MkPath &quot;lal/lad&quot;)      `isParentOf` (MkPath &quot;lal/lad/fad&quot;)</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- &gt;&gt;&gt; (MkPath &quot;/&quot;)            `isParentOf` (MkPath &quot;/&quot;)</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- &gt;&gt;&gt; (MkPath &quot;/lal/lad/fad&quot;) `isParentOf` (MkPath &quot;/lal/lad&quot;)</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- &gt;&gt;&gt; (MkPath &quot;fad&quot;)          `isParentOf` (MkPath &quot;fad&quot;)</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-303"></span><span id="local-6989586621679094254"><span class="annot"><a href="HPath.html#isParentOf"><span class="hs-identifier hs-type">isParentOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094254"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094254"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-304"></span><span id="isParentOf"><span class="annot"><span class="annottext">isParentOf :: Path b -&gt; Path b -&gt; Bool
</span><a href="HPath.html#isParentOf"><span class="hs-identifier hs-var hs-var">isParentOf</span></a></span></span><span> </span><span id="local-6989586621679094253"><span class="annot"><span class="annottext">p :: Path b
</span><a href="#local-6989586621679094253"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679094252"><span class="annot"><span class="annottext">l :: Path b
</span><a href="#local-6989586621679094252"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Path Rel) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path b -&gt; Path b -&gt; Maybe (Path Rel)
forall (m :: * -&gt; *) b.
MonadThrow m =&gt;
Path b -&gt; Path b -&gt; m (Path Rel)
</span><a href="HPath.html#stripDir"><span class="hs-identifier hs-var">stripDir</span></a></span><span> </span><span class="annot"><span class="annottext">Path b
</span><a href="#local-6989586621679094253"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Path b
</span><a href="#local-6989586621679094252"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="HPath.html#Rel"><span class="hs-identifier hs-type">Rel</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">-- |Get all parents of a path.</span><span>
</span><span id="line-308"></span><span class="hs-comment">--</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- &gt;&gt;&gt; getAllParents (MkPath &quot;/abs/def/dod&quot;)</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- [&quot;/abs/def&quot;,&quot;/abs&quot;,&quot;/&quot;]</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- &gt;&gt;&gt; getAllParents (MkPath &quot;/&quot;)</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- []</span><span>
</span><span id="line-313"></span><span class="annot"><a href="HPath.html#getAllParents"><span class="hs-identifier hs-type">getAllParents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="HPath.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="HPath.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-314"></span><span id="getAllParents"><span class="annot"><span class="annottext">getAllParents :: Path Abs -&gt; [Path Abs]
</span><a href="HPath.html#getAllParents"><span class="hs-identifier hs-var hs-var">getAllParents</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-type">MkPath</span></a></span><span> </span><span id="local-6989586621679094250"><span class="annot"><span class="annottext">p :: ByteString
</span><a href="#local-6989586621679094250"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094249"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.singleton</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="System.Posix.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path Abs -&gt; Path Abs
</span><a href="HPath.html#dirname"><span class="hs-identifier hs-var">dirname</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Path Abs
forall b. ByteString -&gt; Path b
</span><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-var">MkPath</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094249"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Path Abs -&gt; [Path Abs] -&gt; [Path Abs]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Path Abs -&gt; [Path Abs]
</span><a href="HPath.html#getAllParents"><span class="hs-identifier hs-var">getAllParents</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs -&gt; Path Abs
</span><a href="HPath.html#dirname"><span class="hs-identifier hs-var">dirname</span></a></span><span> </span><span class="annot"><span class="annottext">(Path Abs -&gt; Path Abs) -&gt; Path Abs -&gt; Path Abs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Path Abs
forall b. ByteString -&gt; Path b
</span><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-var">MkPath</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094249"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679094249"><span class="annot"><span class="annottext">np :: ByteString
</span><a href="#local-6989586621679094249"><span class="hs-identifier hs-var hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="System.Posix.FilePath.html#dropTrailingPathSeparator"><span class="hs-identifier hs-var">dropTrailingPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="System.Posix.FilePath.html#normalise"><span class="hs-identifier hs-var">normalise</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094250"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="hs-comment">-- | Extract the directory name of a path.</span><span>
</span><span id="line-322"></span><span class="hs-comment">--</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- &gt;&gt;&gt; dirname (MkPath &quot;/abc/def/dod&quot;)</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- &quot;/abc/def&quot;</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- &gt;&gt;&gt; dirname (MkPath &quot;/&quot;)</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- &quot;/&quot;</span><span>
</span><span id="line-327"></span><span class="annot"><a href="HPath.html#dirname"><span class="hs-identifier hs-type">dirname</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="HPath.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="HPath.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span>
</span><span id="line-328"></span><span id="dirname"><span class="annot"><span class="annottext">dirname :: Path Abs -&gt; Path Abs
</span><a href="HPath.html#dirname"><span class="hs-identifier hs-var hs-var">dirname</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-type">MkPath</span></a></span><span> </span><span id="local-6989586621679094246"><span class="annot"><span class="annottext">fp :: ByteString
</span><a href="#local-6989586621679094246"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Path Abs
forall b. ByteString -&gt; Path b
</span><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-var">MkPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="System.Posix.FilePath.html#takeDirectory"><span class="hs-identifier hs-var">takeDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="System.Posix.FilePath.html#dropTrailingPathSeparator"><span class="hs-identifier hs-var">dropTrailingPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094246"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="hs-comment">-- | Extract the file part of a path.</span><span>
</span><span id="line-331"></span><span class="hs-comment">--</span><span>
</span><span id="line-332"></span><span class="hs-comment">--</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- The following properties hold:</span><span>
</span><span id="line-334"></span><span class="hs-comment">--</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- @basename (p \&lt;\/&gt; a) == basename a@</span><span>
</span><span id="line-336"></span><span class="hs-comment">--</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- Throws: `PathException` if given the root path &quot;/&quot;</span><span>
</span><span id="line-338"></span><span class="hs-comment">--</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- &gt;&gt;&gt; basename (MkPath &quot;/abc/def/dod&quot;) :: Maybe (Path Fn)</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- Just &quot;dod&quot;</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- &gt;&gt;&gt; basename (MkPath &quot;/abc/def/dod/&quot;) :: Maybe (Path Fn)</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- Just &quot;dod&quot;</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- &gt;&gt;&gt; basename (MkPath &quot;/&quot;)            :: Maybe (Path Fn)</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-345"></span><span id="local-6989586621679094243"><span id="local-6989586621679094244"><span class="annot"><a href="HPath.html#basename"><span class="hs-identifier hs-type">basename</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679094244"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679094243"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679094244"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="HPath.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-346"></span><span id="basename"><span class="annot"><span class="annottext">basename :: Path b -&gt; m (Path Fn)
</span><a href="HPath.html#basename"><span class="hs-identifier hs-var hs-var">basename</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-type">MkPath</span></a></span><span> </span><span id="local-6989586621679094242"><span class="annot"><span class="annottext">l :: ByteString
</span><a href="#local-6989586621679094242"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="System.Posix.FilePath.html#isAbsolute"><span class="hs-identifier hs-var">isAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094241"><span class="hs-identifier hs-var">rl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path Fn -&gt; m (Path Fn)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Path Fn -&gt; m (Path Fn)) -&gt; Path Fn -&gt; m (Path Fn)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Path Fn
forall b. ByteString -&gt; Path b
</span><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-var">MkPath</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094241"><span class="hs-identifier hs-var">rl</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PathException -&gt; m (Path Fn)
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">PathException
</span><a href="HPath.html#RootDirHasNoBasename"><span class="hs-identifier hs-var">RootDirHasNoBasename</span></a></span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-350"></span><span>    </span><span id="local-6989586621679094241"><span class="annot"><span class="annottext">rl :: ByteString
</span><a href="#local-6989586621679094241"><span class="hs-identifier hs-var hs-var">rl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString)
-&gt; (ByteString -&gt; [ByteString]) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString]
</span><a href="System.Posix.FilePath.html#splitPath"><span class="hs-identifier hs-var">splitPath</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; [ByteString])
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; [ByteString]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="System.Posix.FilePath.html#dropTrailingPathSeparator"><span class="hs-identifier hs-var">dropTrailingPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094242"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- Path IO helpers</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span id="local-6989586621679094238"><span class="annot"><a href="HPath.html#withAbsPath"><span class="hs-identifier hs-type">withAbsPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="HPath.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679094238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679094238"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-358"></span><span id="withAbsPath"><span class="annot"><span class="annottext">withAbsPath :: Path Abs -&gt; (ByteString -&gt; IO a) -&gt; IO a
</span><a href="HPath.html#withAbsPath"><span class="hs-identifier hs-var hs-var">withAbsPath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-type">MkPath</span></a></span><span> </span><span id="local-6989586621679094237"><span class="annot"><span class="annottext">p :: ByteString
</span><a href="#local-6989586621679094237"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679094236"><span class="annot"><span class="annottext">action :: ByteString -&gt; IO a
</span><a href="#local-6989586621679094236"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO a
</span><a href="#local-6989586621679094236"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094237"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span id="local-6989586621679094235"><span class="annot"><a href="HPath.html#withRelPath"><span class="hs-identifier hs-type">withRelPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="HPath.html#Rel"><span class="hs-identifier hs-type">Rel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679094235"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679094235"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-362"></span><span id="withRelPath"><span class="annot"><span class="annottext">withRelPath :: Path Rel -&gt; (ByteString -&gt; IO a) -&gt; IO a
</span><a href="HPath.html#withRelPath"><span class="hs-identifier hs-var hs-var">withRelPath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-type">MkPath</span></a></span><span> </span><span id="local-6989586621679094234"><span class="annot"><span class="annottext">p :: ByteString
</span><a href="#local-6989586621679094234"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679094233"><span class="annot"><span class="annottext">action :: ByteString -&gt; IO a
</span><a href="#local-6989586621679094233"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO a
</span><a href="#local-6989586621679094233"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094234"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span id="local-6989586621679094232"><span class="annot"><a href="HPath.html#withFnPath"><span class="hs-identifier hs-type">withFnPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HPath.Internal.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="HPath.html#Fn"><span class="hs-identifier hs-type">Fn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679094232"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679094232"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-366"></span><span id="withFnPath"><span class="annot"><span class="annottext">withFnPath :: Path Fn -&gt; (ByteString -&gt; IO a) -&gt; IO a
</span><a href="HPath.html#withFnPath"><span class="hs-identifier hs-var hs-var">withFnPath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HPath.Internal.html#MkPath"><span class="hs-identifier hs-type">MkPath</span></a></span><span> </span><span id="local-6989586621679094231"><span class="annot"><span class="annottext">p :: ByteString
</span><a href="#local-6989586621679094231"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679094230"><span class="annot"><span class="annottext">action :: ByteString -&gt; IO a
</span><a href="#local-6989586621679094230"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO a
</span><a href="#local-6989586621679094230"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094231"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="hs-comment">------------------------</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- ByteString helpers</span><span class="hs-cpp">

#if MIN_VERSION_bytestring(0,10,8)
</span><span class="hs-cpp">#else
</span><span class="hs-identifier">stripPrefix</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">ByteString</span><span>
</span><span id="line-375"></span><span class="hs-identifier">stripPrefix</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">BS.pack</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">fmap</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">L.stripPrefix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">BS.unpack</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">BS.unpack</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span></pre></body></html>